import{a as Y}from"./chunk-D4Q33I5F.js";import{a as N,c as j,d as A,f as q,h as H,i as Q,o as G,p as J}from"./chunk-E7QGTCB7.js";import{a as K}from"./chunk-GTQ55FTM.js";import{a as z}from"./chunk-EE5B5IH3.js";import{E as s,Ea as R,F as p,G as S,Ga as T,H as I,Ka as W,M as d,Ma as x,N as m,V as b,W as V,X as i,Y as r,Z as g,aa as L,ba as C,d as X,da as O,ea as P,fa as k,ga as B,ha as u,ka as f,la as h,ma as _,oa as F,u as y,x as M,z as w,za as D}from"./chunk-GBGJR6DV.js";var U=X(Y());var v=class c{constructor(e){this.http=e}getCoupon(e){return this.http.get(`/coupons/${e}`)}updateCoupon(e){return this.http.put(`/coupons/${e.id}`,e)}static \u0275fac=function(t){return new(t||c)(M(T))};static \u0275prov=y({token:c,factory:c.\u0275fac,providedIn:"root"})};var ee=["barcode"],E=class c{constructor(e,t,o,n){this.couponEditService=e;this.router=t;this.route=o;this.location=n}coupon={userId:0,name:"",barcode:"",memo:""};couponId="";isLoading=!1;errorMessage="";barcodeElement;ngOnInit(){this.route.paramMap.subscribe(e=>{this.couponId=e.get("id")||"",this.getCouponDetails(this.couponId)}),this.coupon.userId=Number(localStorage.getItem("userId"))}getCouponDetails(e){this.isLoading=!0,this.couponEditService.getCoupon(e).subscribe(t=>{this.coupon=t.data,this.generateBarcode(this.coupon.barcode),this.isLoading=!1},t=>{console.error("\uCFE0\uD3F0 \uC815\uBCF4 \uBD88\uB7EC\uC624\uAE30 \uC2E4\uD328:",t),this.isLoading=!1,this.errorMessage="\uCFE0\uD3F0 \uC815\uBCF4\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4."})}onSubmit(){this.isLoading=!0,this.couponEditService.updateCoupon(this.coupon).subscribe(e=>{this.router.navigate([`/coupons/${this.couponId}`]),this.isLoading=!1},e=>{console.error("\uCFE0\uD3F0 \uC218\uC815 \uC2E4\uD328:",e),this.isLoading=!1,this.errorMessage="\uCFE0\uD3F0 \uC218\uC815\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."})}generateBarcode(e){this.barcodeElement?.nativeElement&&e&&(0,U.default)(this.barcodeElement.nativeElement,e,{format:"CODE128",width:2,height:50,displayValue:!0})}goBack(){this.location.back()}closeErrorPopup(){this.errorMessage=""}static \u0275fac=function(t){return new(t||c)(m(v),m(x),m(W),m(D))};static \u0275cmp=w({type:c,selectors:[["app-coupon-edit"]],viewQuery:function(t,o){if(t&1&&O(ee,5),t&2){let n;P(n=k())&&(o.barcodeElement=n.first)}},standalone:!0,features:[F],decls:28,vars:8,consts:[["couponForm","ngForm"],["barcode",""],[3,"isLoading"],[3,"close","errorMessage"],[1,"container"],[3,"ngSubmit"],["for","name"],["id","name","type","text","name","name","required","",3,"ngModelChange","ngModel"],["for","barcode"],["id","barcode","type","text","name","barcode","required","",3,"ngModelChange","ngModel"],["for","memo"],["id","memo","name","memo",3,"ngModelChange","ngModel"],[1,"button-group"],["type","button",1,"cancel-btn",3,"click"],[1,"fas","fa-arrow-left"],["type","submit",3,"disabled"],[1,"fas","fa-check"]],template:function(t,o){if(t&1){let n=L();g(0,"app-loading-indicator",2),i(1,"app-error-popup",3),C("close",function(){return s(n),p(o.closeErrorPopup())}),r(),i(2,"div",4)(3,"h1"),u(4,"\uCFE0\uD3F0 \uC218\uC815"),r(),i(5,"form",5,0),C("ngSubmit",function(){return s(n),p(o.onSubmit())}),i(7,"div")(8,"label",6),u(9,"\uC774\uB984"),r(),i(10,"input",7),_("ngModelChange",function(a){return s(n),h(o.coupon.name,a)||(o.coupon.name=a),p(a)}),r()(),i(11,"div")(12,"label",8),u(13,"\uBC14\uCF54\uB4DC"),r(),i(14,"input",9),_("ngModelChange",function(a){return s(n),h(o.coupon.barcode,a)||(o.coupon.barcode=a),p(a)}),C("ngModelChange",function(){return s(n),p(o.generateBarcode(o.coupon.barcode))}),r(),S(),g(15,"svg",null,1),r(),I(),i(17,"div")(18,"label",10),u(19,"\uBA54\uBAA8"),r(),i(20,"textarea",11),_("ngModelChange",function(a){return s(n),h(o.coupon.memo,a)||(o.coupon.memo=a),p(a)}),r()(),i(21,"div",12)(22,"button",13),C("click",function(){return s(n),p(o.goBack())}),g(23,"i",14),u(24," \uCDE8\uC18C "),r(),i(25,"button",15),g(26,"i",16),u(27," \uC644\uB8CC "),r()()()()}if(t&2){let n=B(6);b("isLoading",o.isLoading),d(),b("errorMessage",o.errorMessage),d(9),f("ngModel",o.coupon.name),d(4),f("ngModel",o.coupon.barcode),d(),V("hidden",!o.coupon.barcode),d(5),f("ngModel",o.coupon.memo),d(5),b("disabled",n.invalid)}},dependencies:[R,J,Q,N,j,A,G,H,q,z,K],styles:["button[_ngcontent-%COMP%]{border-radius:10px}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px}.cancel-btn[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#333;padding:10px 20px;cursor:pointer;display:flex;align-items:center;border:none;border-radius:10px;transition:background-color .3s}.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#ccc}button[type=submit][_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:10px 20px;cursor:pointer;display:flex;align-items:center;border:none;border-radius:10px;transition:background-color .3s}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#45a049}button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#e0e0e0;color:#aaa;cursor:not-allowed}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:5px}"]})};export{E as default};
