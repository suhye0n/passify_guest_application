import{a as re}from"./chunk-QLAOAXEV.js";import{a as H,c as Q,d as z,f as G,h as J,i as K,l as U,m as X,n as Y,o as Z,p as $}from"./chunk-ONP6AOLD.js";import{a as te}from"./chunk-DZFP2UU4.js";import{a as ee}from"./chunk-VNP4B37G.js";import{Aa as L,Ca as N,Da as W,E as c,F as m,Fa as R,G as A,H as O,Ha as j,M as l,N as h,Na as q,T as y,V as p,W as V,X as n,Y as o,Z as u,aa as B,ba as f,d as oe,da as T,ea as D,fa as k,ga as F,ha as s,ia as M,ka as b,la as C,ma as _,oa as x,pa as S,u as w,x as I,z as E}from"./chunk-T7GGXQV6.js";var ne=oe(re());var v=class a{constructor(e){this.http=e}getTitles(){return this.http.get("/titles")}getTags(){return this.http.get("/tags")}addPoint(e){let i={titleId:Number(e.titleId),barcode:e.barcode,memo:e.memo,tagId:e.tagId===null?null:Number(e.tagId),type:e.type};return this.http.post("/passes",i)}static \u0275fac=function(i){return new(i||a)(I(j))};static \u0275prov=w({token:a,factory:a.\u0275fac,providedIn:"root"})};var de=["barcodeSvg"],ie=()=>[];function se(a,e){a&1&&(n(0,"option",23),s(1,"\uD3EC\uC778\uD2B8\uBA85\uC774 \uC5C6\uC2B5\uB2C8\uB2E4."),o())}function pe(a,e){if(a&1&&(n(0,"option",17),s(1),o()),a&2){let i=e.$implicit;p("value",i.id),l(),M(i.name)}}function ce(a,e){if(a&1&&(n(0,"option",17),s(1),o()),a&2){let i=e.$implicit;p("value",i.id),l(),M(i.name)}}var P=class a{constructor(e,i,t){this.pointAddService=e;this.router=i;this.location=t}point={userId:0,titleId:null,tagId:null,barcode:"",memo:"",type:"POINT"};isLoading=!1;errorMessage="";titles=[];tags=[];barcodeSvgElement;ngOnInit(){this.point.userId=Number(localStorage.getItem("userId")),this.fetchTitles(),this.fetchTags()}fetchTitles(){this.pointAddService.getTitles().subscribe(e=>{this.titles=e.data,this.titles.length>0&&(this.point.titleId=this.titles[0].id)},e=>{this.errorMessage="\uD3EC\uC778\uD2B8\uBA85 \uC815\uBCF4\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.",console.log(e)})}fetchTags(){this.pointAddService.getTags().subscribe(e=>{this.tags=e.data},e=>{this.errorMessage="\uD0DC\uADF8 \uC815\uBCF4\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.",console.log(e)})}onSubmit(){this.isLoading=!0,this.pointAddService.addPoint(this.point).subscribe(e=>{this.isLoading=!1,this.router.navigate(["/points"])},e=>{this.isLoading=!1,this.errorMessage="\uD3EC\uC778\uD2B8 \uCD94\uAC00 \uC2E4\uD328: "+e.message})}generateBarcode(e){e&&this.barcodeSvgElement?.nativeElement&&(0,ne.default)(this.barcodeSvgElement.nativeElement,e,{format:"CODE128",width:2,height:50,displayValue:!0})}goBack(){this.location.back()}closeErrorPopup(){this.errorMessage=""}static \u0275fac=function(i){return new(i||a)(h(v),h(q),h(L))};static \u0275cmp=E({type:a,selectors:[["app-point-add"]],viewQuery:function(i,t){if(i&1&&T(de,5),i&2){let d;D(d=k())&&(t.barcodeSvgElement=d.first)}},standalone:!0,features:[x],decls:38,vars:15,consts:[["pointForm","ngForm"],["barcode","ngModel"],["barcodeSvg",""],[3,"isLoading"],[3,"close","errorMessage"],[1,"container"],[3,"ngSubmit"],["for","title"],["id","title","name","titleId","required","",3,"ngModelChange","ngModel"],["value","","disabled","",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["for","barcode"],["id","barcode","type","text","name","barcode","required","",3,"ngModelChange","ngModel"],["for","memo"],["id","memo","name","memo",3,"ngModelChange","ngModel"],["for","tag"],["id","tag","name","tagId",3,"ngModelChange","ngModel"],[3,"value"],[1,"button-group"],["type","button",1,"cancel-btn",3,"click"],[1,"fas","fa-arrow-left"],["type","submit",3,"disabled"],[1,"fas","fa-check"],["value","","disabled",""]],template:function(i,t){if(i&1){let d=B();u(0,"app-loading-indicator",3),n(1,"app-error-popup",4),f("close",function(){return c(d),m(t.closeErrorPopup())}),o(),n(2,"div",5)(3,"h1"),s(4,"\uD3EC\uC778\uD2B8 \uCD94\uAC00"),o(),n(5,"form",6,0),f("ngSubmit",function(){return c(d),m(t.onSubmit())}),n(7,"div")(8,"label",7),s(9,"\uD3EC\uC778\uD2B8\uBA85"),o(),n(10,"select",8),_("ngModelChange",function(r){return c(d),C(t.point.titleId,r)||(t.point.titleId=r),m(r)}),y(11,se,2,0,"option",9)(12,pe,2,2,"option",10),o()(),n(13,"div")(14,"label",11),s(15,"\uBC14\uCF54\uB4DC"),o(),n(16,"input",12,1),_("ngModelChange",function(r){return c(d),C(t.point.barcode,r)||(t.point.barcode=r),m(r)}),f("ngModelChange",function(){return c(d),m(t.generateBarcode(t.point.barcode))}),o(),A(),u(18,"svg",null,2),o(),O(),n(20,"div")(21,"label",13),s(22,"\uBA54\uBAA8"),o(),n(23,"textarea",14),_("ngModelChange",function(r){return c(d),C(t.point.memo,r)||(t.point.memo=r),m(r)}),o()(),n(24,"div")(25,"label",15),s(26,"\uD0DC\uADF8"),o(),n(27,"select",16),_("ngModelChange",function(r){return c(d),C(t.point.tagId,r)||(t.point.tagId=r),m(r)}),n(28,"option",17),s(29,"--- \uC120\uD0DD ---"),o(),y(30,ce,2,2,"option",10),o()(),n(31,"div",18)(32,"button",19),f("click",function(){return c(d),m(t.goBack())}),u(33,"i",20),s(34," \uCDE8\uC18C "),o(),n(35,"button",21),u(36,"i",22),s(37," \uC644\uB8CC "),o()()()()}if(i&2){let d=F(6);p("isLoading",t.isLoading),l(),p("errorMessage",t.errorMessage),l(9),b("ngModel",t.point.titleId),l(),p("ngIf",!(t.titles!=null&&t.titles.length)),l(),p("ngForOf",t.titles||S(13,ie)),l(4),b("ngModel",t.point.barcode),l(2),V("hidden",!t.point.barcode),l(5),b("ngModel",t.point.memo),l(4),b("ngModel",t.point.tagId),l(),p("value",null),l(2),p("ngForOf",t.tags||S(14,ie)),l(5),p("disabled",d.invalid)}},dependencies:[R,N,W,$,K,X,Y,H,U,Q,z,Z,J,G,ee,te],styles:["button[_ngcontent-%COMP%]{border-radius:10px}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px}.cancel-btn[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#333;padding:10px 20px;cursor:pointer;display:flex;align-items:center;border:none;border-radius:10px;transition:background-color .3s}.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#ccc}button[type=submit][_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:10px 20px;cursor:pointer;display:flex;align-items:center;border:none;border-radius:10px;transition:background-color .3s}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#45a049}button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#e0e0e0;color:#aaa;cursor:not-allowed}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:5px}select[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border-radius:5px;border:1px solid #ccc;font-size:16px;background-color:#f9f9f9;transition:border-color .3s}select[_ngcontent-%COMP%]:focus{border-color:#4caf50;outline:none;background-color:#e8f5e9}#title[_ngcontent-%COMP%], #tag[_ngcontent-%COMP%]{margin-bottom:20px}label[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:#333;margin-bottom:5px;display:block}select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:disabled{color:#888;font-style:italic}"]})};export{P as default};
