import{a as ae}from"./chunk-QLAOAXEV.js";import{a as Q,c as z,d as G,f as J,h as K,i as U,l as X,m as Y,n as Z,o as $,p as ee}from"./chunk-ONP6AOLD.js";import{a as ie}from"./chunk-DZFP2UU4.js";import{a as te}from"./chunk-VNP4B37G.js";import{Aa as A,Ca as W,Da as N,E as p,F as m,Fa as R,G as P,H as B,Ha as j,La as q,M as l,N as g,Na as H,T as y,V as c,W as V,X as n,Y as r,Z as C,aa as T,ba as f,d as oe,da as L,ea as k,fa as D,ga as F,ha as s,ia as E,ka as b,la as _,ma as h,oa as x,pa as M,u as w,x as I,z as O}from"./chunk-T7GGXQV6.js";var re=oe(ae());var v=class a{constructor(e){this.http=e}getCard(e){return this.http.get(`/passes/${e}`)}updateCard(e){return this.http.put(`/passes/${e.id}`,e)}getTags(){return this.http.get("/tags")}getTitles(){return this.http.get("/titles")}static \u0275fac=function(i){return new(i||a)(I(j))};static \u0275prov=w({token:a,factory:a.\u0275fac,providedIn:"root"})};var se=["barcode"],ne=()=>[];function ce(a,e){a&1&&(n(0,"option",22),s(1,"\uCE74\uB4DC\uBA85\uC774 \uC5C6\uC2B5\uB2C8\uB2E4."),r())}function pe(a,e){if(a&1&&(n(0,"option",16),s(1),r()),a&2){let i=e.$implicit;c("value",i.id),l(),E(i.name)}}function me(a,e){if(a&1&&(n(0,"option",16),s(1),r()),a&2){let i=e.$implicit;c("value",i.id),l(),E(i.name)}}var S=class a{constructor(e,i,t,d){this.cardEditService=e;this.router=i;this.route=t;this.location=d}card={id:0,barcode:"",memo:"",tagId:0,titleId:0};cardId="";isLoading=!1;errorMessage="";tags=[];titles=[];barcodeElement;ngOnInit(){this.route.paramMap.subscribe(e=>{this.cardId=e.get("id")||"",this.getCardDetails(this.cardId)}),this.loadTagsAndTitles()}getCardDetails(e){this.isLoading=!0,this.cardEditService.getCard(e).subscribe(i=>{this.card=i.data,this.generateBarcode(this.card.barcode),this.isLoading=!1},i=>{console.error("\uCE74\uB4DC \uC815\uBCF4 \uBD88\uB7EC\uC624\uAE30 \uC2E4\uD328:",i),this.isLoading=!1,this.errorMessage="\uCE74\uB4DC \uC815\uBCF4\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4."})}loadTagsAndTitles(){this.cardEditService.getTags().subscribe(e=>{this.tags=e.data},e=>{console.error("\uD0DC\uADF8 \uBD88\uB7EC\uC624\uAE30 \uC2E4\uD328:",e),this.errorMessage="\uD0DC\uADF8 \uC815\uBCF4\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4."}),this.cardEditService.getTitles().subscribe(e=>{this.titles=e.data},e=>{console.error("\uCE74\uB4DC\uBA85 \uBD88\uB7EC\uC624\uAE30 \uC2E4\uD328:",e),this.errorMessage="\uCE74\uB4DC\uBA85 \uC815\uBCF4\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4."})}onSubmit(){this.isLoading=!0,this.cardEditService.updateCard(this.card).subscribe(e=>{this.router.navigate([`/cards/${this.cardId}`]),this.isLoading=!1},e=>{console.error("\uCE74\uB4DC \uC218\uC815 \uC2E4\uD328:",e),this.isLoading=!1,this.errorMessage="\uCE74\uB4DC \uC218\uC815\uC5D0 \uC2E4\uD328\uD588\uC2B5\uB2C8\uB2E4."})}generateBarcode(e){this.barcodeElement?.nativeElement&&e&&(0,re.default)(this.barcodeElement.nativeElement,e,{format:"CODE128",width:2,height:50,displayValue:!0})}goBack(){this.location.back()}closeErrorPopup(){this.errorMessage=""}static \u0275fac=function(i){return new(i||a)(g(v),g(H),g(q),g(A))};static \u0275cmp=O({type:a,selectors:[["app-card-edit"]],viewQuery:function(i,t){if(i&1&&L(se,5),i&2){let d;k(d=D())&&(t.barcodeElement=d.first)}},standalone:!0,features:[x],decls:37,vars:15,consts:[["cardForm","ngForm"],["barcode",""],[3,"isLoading"],[3,"close","errorMessage"],[1,"container"],[3,"ngSubmit"],["for","title"],["id","title","name","titleId","required","",3,"ngModelChange","ngModel"],["value","","disabled","",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["for","barcode"],["id","barcode","type","text","name","barcode","required","",3,"ngModelChange","ngModel"],["for","memo"],["id","memo","name","memo",3,"ngModelChange","ngModel"],["for","tag"],["id","tag","name","tagId",3,"ngModelChange","ngModel"],[3,"value"],[1,"button-group"],["type","button",1,"cancel-btn",3,"click"],[1,"fas","fa-arrow-left"],["type","submit",3,"disabled"],[1,"fas","fa-check"],["value","","disabled",""]],template:function(i,t){if(i&1){let d=T();C(0,"app-loading-indicator",2),n(1,"app-error-popup",3),f("close",function(){return p(d),m(t.closeErrorPopup())}),r(),n(2,"div",4)(3,"h1"),s(4,"\uCE74\uB4DC \uC218\uC815"),r(),n(5,"form",5,0),f("ngSubmit",function(){return p(d),m(t.onSubmit())}),n(7,"div")(8,"label",6),s(9,"\uCE74\uB4DC\uBA85"),r(),n(10,"select",7),h("ngModelChange",function(o){return p(d),_(t.card.titleId,o)||(t.card.titleId=o),m(o)}),y(11,ce,2,0,"option",8)(12,pe,2,2,"option",9),r()(),n(13,"div")(14,"label",10),s(15,"\uBC14\uCF54\uB4DC"),r(),n(16,"input",11),h("ngModelChange",function(o){return p(d),_(t.card.barcode,o)||(t.card.barcode=o),m(o)}),f("ngModelChange",function(){return p(d),m(t.generateBarcode(t.card.barcode))}),r(),P(),C(17,"svg",null,1),r(),B(),n(19,"div")(20,"label",12),s(21,"\uBA54\uBAA8"),r(),n(22,"textarea",13),h("ngModelChange",function(o){return p(d),_(t.card.memo,o)||(t.card.memo=o),m(o)}),r()(),n(23,"div")(24,"label",14),s(25,"\uD0DC\uADF8"),r(),n(26,"select",15),h("ngModelChange",function(o){return p(d),_(t.card.tagId,o)||(t.card.tagId=o),m(o)}),n(27,"option",16),s(28,"--- \uC120\uD0DD ---"),r(),y(29,me,2,2,"option",9),r()(),n(30,"div",17)(31,"button",18),f("click",function(){return p(d),m(t.goBack())}),C(32,"i",19),s(33," \uCDE8\uC18C "),r(),n(34,"button",20),C(35,"i",21),s(36," \uC644\uB8CC "),r()()()()}if(i&2){let d=F(6);c("isLoading",t.isLoading),l(),c("errorMessage",t.errorMessage),l(9),b("ngModel",t.card.titleId),l(),c("ngIf",!(t.titles!=null&&t.titles.length)),l(),c("ngForOf",t.titles||M(13,ne)),l(4),b("ngModel",t.card.barcode),l(),V("hidden",!t.card.barcode),l(5),b("ngModel",t.card.memo),l(4),b("ngModel",t.card.tagId),l(),c("value",null),l(2),c("ngForOf",t.tags||M(14,ne)),l(5),c("disabled",d.invalid)}},dependencies:[R,W,N,ee,U,Y,Z,Q,X,z,G,$,K,J,te,ie],styles:["button[_ngcontent-%COMP%]{border-radius:10px}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px}.cancel-btn[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#333;padding:10px 20px;cursor:pointer;display:flex;align-items:center;border:none;border-radius:10px;transition:background-color .3s}.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#ccc}button[type=submit][_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:10px 20px;cursor:pointer;display:flex;align-items:center;border:none;border-radius:10px;transition:background-color .3s}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#45a049}button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#e0e0e0;color:#aaa;cursor:not-allowed}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:5px}select[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border-radius:5px;border:1px solid #ccc;font-size:16px;background-color:#f9f9f9;transition:border-color .3s}select[_ngcontent-%COMP%]:focus{border-color:#4caf50;outline:none;background-color:#e8f5e9}#title[_ngcontent-%COMP%], #tag[_ngcontent-%COMP%]{margin-bottom:20px}label[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:#333;margin-bottom:5px;display:block}select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:disabled{color:#888;font-style:italic}"]})};export{S as default};
