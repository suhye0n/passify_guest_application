import{b as O,c as k}from"./chunk-PWBUOXLA.js";import{a as x,b as v,c as P,d as L,e as N,g as _,i as G,j as R,k as V,q}from"./chunk-ONP6AOLD.js";import{a as j}from"./chunk-VNP4B37G.js";import{Ca as E,Da as D,Fa as M,J as y,La as I,M as i,Na as T,Oa as B,T as C,V as u,W as g,X as a,Y as s,Z as d,ba as b,ca as f,ha as m,ia as S,ja as c,oa as A,y as p,z as F}from"./chunk-T7GGXQV6.js";function z(o,r){if(o&1&&(a(0,"div",13)(1,"ul")(2,"li"),m(3),s()()()),o&2){let e,t=f(2);i(3),c(" ",(e=t.authForm.get("passwordConfirmation"))==null?null:e.getError("passwordMismatch")," ")}}function $(o,r){if(o&1&&(a(0,"div",4),d(1,"input",12),C(2,z,4,1,"div",8),s()),o&2){let e,t,n=f();i(),g("invalid",((e=n.authForm.get("passwordConfirmation"))==null?null:e.invalid)&&((e=n.authForm.get("passwordConfirmation"))==null?null:e.touched)),i(),u("ngIf",(t=n.authForm.get("passwordConfirmation"))==null?null:t.hasError("passwordMismatch"))}}function U(o,r){if(o&1&&(a(0,"li"),m(1),s()),o&2){let e=r.$implicit;i(),c(" ",e[1]," ")}}function H(o,r){if(o&1&&(a(0,"div",13)(1,"ul"),C(2,U,2,1,"li",14),s()()),o&2){let e=f();i(2),u("ngForOf",e.errorEntries)}}var w=class o{authType="";title="";isSubmitting=!1;errors={detail:{}};authForm;isLoading=!1;destroyRef=p(y);userService=p(O);route=p(I);router=p(T);constructor(){this.authForm=this.createAuthForm()}ngOnInit(){this.initializeAuthType(),this.authForm.get("password")?.valueChanges.subscribe(()=>this.checkPasswordMatch()),this.authForm.get("passwordConfirmation")?.valueChanges.subscribe(()=>this.checkPasswordMatch())}createAuthForm(){return new N({email:new _("",[v.required]),password:new _("",[v.required]),passwordConfirmation:new _("",[v.required])})}initializeAuthType(){this.authType=this.route.snapshot.url.at(-1)?.path||"",this.title=this.authType==="login"?"\uB85C\uADF8\uC778":"\uD68C\uC6D0\uAC00\uC785"}checkPasswordMatch(){let r=this.authForm.get("password")?.value,e=this.authForm.get("passwordConfirmation")?.value;r&&e&&r!==e?this.authForm.get("passwordConfirmation")?.setErrors({passwordMismatch:"\uBE44\uBC00\uBC88\uD638\uAC00 \uC77C\uCE58\uD558\uC9C0 \uC54A\uC2B5\uB2C8\uB2E4."}):this.authForm.get("passwordConfirmation")?.setErrors(null)}onSubmit(){if(this.isSubmitting)return;this.isSubmitting=!0,this.isLoading=!0,this.errors={detail:{}};let r=this.authForm.value;(this.authType==="login"?this.userService.login({email:r.email,password:r.password}):this.userService.signup({email:r.email,password:r.password})).pipe(k(this.destroyRef)).subscribe({next:()=>{this.isLoading=!1,this.router.navigate(["/"])},error:t=>{if(this.isLoading=!1,t&&t.message){let n=t.message.split(", ").map(h=>h.trim()),l={};n.forEach(h=>{l[h]=h}),this.errors={detail:l}}this.isSubmitting=!1}})}get errorEntries(){return Object.entries(this.errors.detail)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=F({type:o,selectors:[["app-auth-page"]],standalone:!0,features:[A],decls:17,vars:13,consts:[[3,"isLoading"],[1,"container"],[1,"auth-header"],[1,"auth-form",3,"ngSubmit","formGroup"],[1,"input-group"],["id","email","type","email","formControlName","email","placeholder","\uC774\uBA54\uC77C\uC744 \uC785\uB825\uD558\uC138\uC694"],["id","password","type","password","formControlName","password","placeholder","\uBE44\uBC00\uBC88\uD638\uB97C \uC785\uB825\uD558\uC138\uC694"],["class","input-group",4,"ngIf"],["class","error-message",4,"ngIf"],["type","submit",3,"disabled"],[1,"link"],[3,"routerLink"],["id","passwordConfirmation","type","password","formControlName","passwordConfirmation","placeholder","\uBE44\uBC00\uBC88\uD638 \uD655\uC778"],[1,"error-message"],[4,"ngFor","ngForOf"]],template:function(e,t){if(e&1&&(d(0,"app-loading-indicator",0),a(1,"div",1)(2,"div",2)(3,"h1"),m(4),s()(),a(5,"form",3),b("ngSubmit",function(){return t.onSubmit()}),a(6,"div",4),d(7,"input",5),s(),a(8,"div",4),d(9,"input",6),s(),C(10,$,3,3,"div",7)(11,H,3,1,"div",8),a(12,"button",9),m(13),s()(),a(14,"div",10)(15,"a",11),m(16),s()()()),e&2){let n,l;u("isLoading",t.isLoading),i(4),S(t.title),i(),u("formGroup",t.authForm),i(2),g("invalid",((n=t.authForm.get("email"))==null?null:n.invalid)&&((n=t.authForm.get("email"))==null?null:n.touched)),i(2),g("invalid",((l=t.authForm.get("password"))==null?null:l.invalid)&&((l=t.authForm.get("password"))==null?null:l.touched)),i(),u("ngIf",t.authType==="signup"),i(),u("ngIf",t.errors&&t.errors.detail&&t.errorEntries.length),i(),u("disabled",t.isSubmitting||t.authForm.invalid),i(),c(" ",t.authType==="login"?"\uB85C\uADF8\uC778":"\uD68C\uC6D0\uAC00\uC785"," "),i(2),u("routerLink",t.authType==="login"?"/signup":"/login"),i(),c(" ",t.authType==="login"?"\uACC4\uC815\uC774 \uC5C6\uC73C\uC2E0\uAC00\uC694? \uD68C\uC6D0\uAC00\uC785":"\uC774\uBBF8 \uACC4\uC815\uC774 \uC788\uC73C\uC2E0\uAC00\uC694? \uB85C\uADF8\uC778"," ")}},dependencies:[q,G,x,P,L,R,V,B,M,E,D,j],styles:[".auth-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}.link[_ngcontent-%COMP%]{text-align:center;margin-top:2rem}.link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#ff9aa7;text-decoration:none;font-size:1rem;transition:color .3s ease}.link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#ff7b8d;text-decoration:underline}"]})};export{w as default};
