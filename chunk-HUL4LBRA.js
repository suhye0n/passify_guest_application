import{a as re}from"./chunk-QLAOAXEV.js";import{a as H,c as Q,d as z,f as G,h as J,i as U,l as K,m as X,n as Y,o as Z,p as $}from"./chunk-ONP6AOLD.js";import{a as te}from"./chunk-DZFP2UU4.js";import{a as ee}from"./chunk-VNP4B37G.js";import{Aa as L,Ca as N,Da as W,E as c,F as u,Fa as R,G as A,H as P,Ha as j,M as l,N as h,Na as q,T as y,V as p,W as F,X as n,Y as i,Z as g,aa as V,ba as C,d as ie,da as T,ea as B,fa as k,ga as D,ha as s,ia as M,ka as f,la as b,ma as _,oa as x,pa as S,u as I,x as E,z as O}from"./chunk-T7GGXQV6.js";var ne=ie(re());var v=class a{constructor(e){this.http=e}getTitles(){return this.http.get("/titles")}getTags(){return this.http.get("/tags")}addCoupon(e){let o={titleId:Number(e.titleId),barcode:e.barcode,memo:e.memo,tagId:e.tagId===null?null:Number(e.tagId),type:e.type};return this.http.post("/passes",o)}static \u0275fac=function(o){return new(o||a)(E(j))};static \u0275prov=I({token:a,factory:a.\u0275fac,providedIn:"root"})};var de=["barcodeSvg"],oe=()=>[];function se(a,e){a&1&&(n(0,"option",23),s(1,"\uCFE0\uD3F0\uBA85\uC774 \uC5C6\uC2B5\uB2C8\uB2E4."),i())}function pe(a,e){if(a&1&&(n(0,"option",17),s(1),i()),a&2){let o=e.$implicit;p("value",o.id),l(),M(o.name)}}function ce(a,e){if(a&1&&(n(0,"option",17),s(1),i()),a&2){let o=e.$implicit;p("value",o.id),l(),M(o.name)}}var w=class a{constructor(e,o,t){this.couponAddService=e;this.router=o;this.location=t}coupon={userId:0,titleId:null,tagId:null,barcode:"",memo:"",type:"COUPON"};isLoading=!1;errorMessage="";titles=[];tags=[];barcodeSvgElement;ngOnInit(){this.coupon.userId=Number(localStorage.getItem("userId")),this.fetchTitles(),this.fetchTags()}fetchTitles(){this.couponAddService.getTitles().subscribe(e=>{this.titles=e.data,this.titles.length>0&&(this.coupon.titleId=this.titles[0].id)},e=>{this.errorMessage="\uCFE0\uD3F0\uBA85 \uC815\uBCF4\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.",console.log(e)})}fetchTags(){this.couponAddService.getTags().subscribe(e=>{this.tags=e.data},e=>{this.errorMessage="\uD0DC\uADF8 \uC815\uBCF4\uB97C \uBD88\uB7EC\uC624\uC9C0 \uBABB\uD588\uC2B5\uB2C8\uB2E4.",console.log(e)})}onSubmit(){this.isLoading=!0,this.couponAddService.addCoupon(this.coupon).subscribe(e=>{this.isLoading=!1,this.router.navigate(["/coupons"])},e=>{this.isLoading=!1,this.errorMessage="\uCFE0\uD3F0 \uCD94\uAC00 \uC2E4\uD328: "+e.message})}generateBarcode(e){e&&this.barcodeSvgElement?.nativeElement&&(0,ne.default)(this.barcodeSvgElement.nativeElement,e,{format:"CODE128",width:2,height:50,displayValue:!0})}goBack(){this.location.back()}closeErrorPopup(){this.errorMessage=""}static \u0275fac=function(o){return new(o||a)(h(v),h(q),h(L))};static \u0275cmp=O({type:a,selectors:[["app-coupon-add"]],viewQuery:function(o,t){if(o&1&&T(de,5),o&2){let d;B(d=k())&&(t.barcodeSvgElement=d.first)}},standalone:!0,features:[x],decls:38,vars:15,consts:[["couponForm","ngForm"],["barcode","ngModel"],["barcodeSvg",""],[3,"isLoading"],[3,"close","errorMessage"],[1,"container"],[3,"ngSubmit"],["for","title"],["id","title","name","titleId","required","",3,"ngModelChange","ngModel"],["value","","disabled","",4,"ngIf"],[3,"value",4,"ngFor","ngForOf"],["for","barcode"],["id","barcode","type","text","name","barcode","required","",3,"ngModelChange","ngModel"],["for","memo"],["id","memo","name","memo",3,"ngModelChange","ngModel"],["for","tag"],["id","tag","name","tagId",3,"ngModelChange","ngModel"],[3,"value"],[1,"button-group"],["type","button",1,"cancel-btn",3,"click"],[1,"fas","fa-arrow-left"],["type","submit",3,"disabled"],[1,"fas","fa-check"],["value","","disabled",""]],template:function(o,t){if(o&1){let d=V();g(0,"app-loading-indicator",3),n(1,"app-error-popup",4),C("close",function(){return c(d),u(t.closeErrorPopup())}),i(),n(2,"div",5)(3,"h1"),s(4,"\uCFE0\uD3F0 \uCD94\uAC00"),i(),n(5,"form",6,0),C("ngSubmit",function(){return c(d),u(t.onSubmit())}),n(7,"div")(8,"label",7),s(9,"\uCFE0\uD3F0\uBA85"),i(),n(10,"select",8),_("ngModelChange",function(r){return c(d),b(t.coupon.titleId,r)||(t.coupon.titleId=r),u(r)}),y(11,se,2,0,"option",9)(12,pe,2,2,"option",10),i()(),n(13,"div")(14,"label",11),s(15,"\uBC14\uCF54\uB4DC"),i(),n(16,"input",12,1),_("ngModelChange",function(r){return c(d),b(t.coupon.barcode,r)||(t.coupon.barcode=r),u(r)}),C("ngModelChange",function(){return c(d),u(t.generateBarcode(t.coupon.barcode))}),i(),A(),g(18,"svg",null,2),i(),P(),n(20,"div")(21,"label",13),s(22,"\uBA54\uBAA8"),i(),n(23,"textarea",14),_("ngModelChange",function(r){return c(d),b(t.coupon.memo,r)||(t.coupon.memo=r),u(r)}),i()(),n(24,"div")(25,"label",15),s(26,"\uD0DC\uADF8"),i(),n(27,"select",16),_("ngModelChange",function(r){return c(d),b(t.coupon.tagId,r)||(t.coupon.tagId=r),u(r)}),n(28,"option",17),s(29,"--- \uC120\uD0DD ---"),i(),y(30,ce,2,2,"option",10),i()(),n(31,"div",18)(32,"button",19),C("click",function(){return c(d),u(t.goBack())}),g(33,"i",20),s(34," \uCDE8\uC18C "),i(),n(35,"button",21),g(36,"i",22),s(37," \uC644\uB8CC "),i()()()()}if(o&2){let d=D(6);p("isLoading",t.isLoading),l(),p("errorMessage",t.errorMessage),l(9),f("ngModel",t.coupon.titleId),l(),p("ngIf",!(t.titles!=null&&t.titles.length)),l(),p("ngForOf",t.titles||S(13,oe)),l(4),f("ngModel",t.coupon.barcode),l(2),F("hidden",!t.coupon.barcode),l(5),f("ngModel",t.coupon.memo),l(4),f("ngModel",t.coupon.tagId),l(),p("value",null),l(2),p("ngForOf",t.tags||S(14,oe)),l(5),p("disabled",d.invalid)}},dependencies:[R,N,W,$,U,X,Y,H,K,Q,z,Z,J,G,ee,te],styles:["button[_ngcontent-%COMP%]{border-radius:10px}.button-group[_ngcontent-%COMP%]{display:flex;gap:10px}.cancel-btn[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#333;padding:10px 20px;cursor:pointer;display:flex;align-items:center;border:none;border-radius:10px;transition:background-color .3s}.cancel-btn[_ngcontent-%COMP%]:hover{background-color:#ccc}button[type=submit][_ngcontent-%COMP%]{background-color:#4caf50;color:#fff;padding:10px 20px;cursor:pointer;display:flex;align-items:center;border:none;border-radius:10px;transition:background-color .3s}button[type=submit][_ngcontent-%COMP%]:hover{background-color:#45a049}button[type=submit][_ngcontent-%COMP%]:disabled{background-color:#e0e0e0;color:#aaa;cursor:not-allowed}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:5px}select[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border-radius:5px;border:1px solid #ccc;font-size:16px;background-color:#f9f9f9;transition:border-color .3s}select[_ngcontent-%COMP%]:focus{border-color:#4caf50;outline:none;background-color:#e8f5e9}#title[_ngcontent-%COMP%], #tag[_ngcontent-%COMP%]{margin-bottom:20px}label[_ngcontent-%COMP%]{font-weight:700;font-size:16px;color:#333;margin-bottom:5px;display:block}select[_ngcontent-%COMP%]   option[_ngcontent-%COMP%]:disabled{color:#888;font-style:italic}"]})};export{w as default};
